<?phpinclude_once("dbconfig.php");include_once("functions.php");function addCalendar($st, $et, $sub, $ade) {    $ret = array();    $ret['IsSuccess'] = true;    $ret['Msg'] = 'add success';    $ret['Data'] = rand();    return $ret;}function addDetailedCalendar($st, $et, $sub, $ade, $dscr, $loc, $color, $tz) {    $ret = array();    $ret['IsSuccess'] = true;    $ret['Msg'] = 'add success';    $ret['Data'] = rand();    return $ret;}function listCalendarByRange($sd, $ed, $cnt) {    $ret = array();    $ret['events'] = array();    $ret['issort'] = true;    $ret['start'] = php2JsTime($sd);    $ret['end'] = php2JsTime($ed);    $ret['error'] = null;    $title = array('team meeting', 'remote meeting', 'project plan review', 'annual report', 'go to dinner');    $location = array('Lodan', 'Newswer', 'Belion', 'Moore', 'Bytelin');    for ($i = 0; $i < $cnt; $i++) {        $rsd = rand($sd, $ed);        $red = rand(3600, 10800);        if (rand(0, 10) > 8) {            $alld = 1;        } else {            $alld = 0;        }        $ret['events'][] = array(            rand(10000, 99999),            $title[rand(0, 4)],            php2JsTime($rsd),            php2JsTime($red),            rand(0, 1),            $alld, //more than one day event            0, //Recurring event            rand(-1, 13),            1, //editable            $location[rand(0, 4)],            ''//$attends        );    }    return $ret;}function listCalendar($day, $type) {    $phpTime = js2PhpTime($day);    //echo $phpTime . "+" . $type;    switch ($type) {        case 'month':            $st = mktime(0, 0, 0, date("m", $phpTime), 1, date("Y", $phpTime));            $et = mktime(0, 0, -1, date("m", $phpTime) + 1, 1, date("Y", $phpTime));            $cnt = 50;            break;        case 'week':            //suppose first day of a week is monday             $monday = date("d", $phpTime) - date('N', $phpTime) + 1;            //echo date('N', $phpTime);            $st = mktime(0, 0, 0, date("m", $phpTime), $monday, date("Y", $phpTime));            $et = mktime(0, 0, -1, date("m", $phpTime), $monday + 7, date("Y", $phpTime));            $cnt = 20;            break;        case 'day':            $st = mktime(0, 0, 0, date("m", $phpTime), date("d", $phpTime), date("Y", $phpTime));            $et = mktime(0, 0, -1, date("m", $phpTime), date("d", $phpTime) + 1, date("Y", $phpTime));            $cnt = 5;            break;    }    //echo $st . "--" . $et;    return listCalendarByRange($st, $et, $cnt);}function updateCalendar($id, $st, $et) {    $ret = array();    $ret['IsSuccess'] = true;    $ret['Msg'] = 'Succefully';    return $ret;}function updateDetailedCalendar($id, $st, $et, $sub, $ade, $dscr, $loc, $color, $tz) {    $ret = array();    $ret['IsSuccess'] = true;    $ret['Msg'] = 'Succefully';    return $ret;}function removeCalendar($id) {    $ret = array();    $ret['IsSuccess'] = true;    $ret['Msg'] = 'Succefully';    return $ret;}header('Content-type:text/javascript;charset=UTF-8');$method = filter_input(INPUT_GET, 'method', FILTER_SANITIZE_STRING);$post = filter_input_array(INPUT_POST, FILTER_SANITIZE_STRING);switch ($method) {    case 'add':        $ret = addCalendar($post['CalendarStartTime'], $post['CalendarEndTime'], $post['CalendarTitle'], $post['IsAllDayEvent']);        break;    case 'list':        $ret = listCalendar($post['showdate'], $post['viewtype']);        break;    case 'update':        $ret = updateCalendar($post['calendarId'], $post['CalendarStartTime'], $post['CalendarEndTime']);        break;    case 'remove':        $ret = removeCalendar($post['calendarId']);        break;    case 'adddetails':        $id = filter_input(INPUT_GET, 'id', FILTER_SANITIZE_STRING);        $st = $post['stpartdate'] . ' ' . $post['stparttime'];        $et = $post['etpartdate'] . ' ' . $post['etparttime'];        if ($id) {            $ret = updateDetailedCalendar($id, $st, $et, $post['Subject'], $post['IsAllDayEvent'] ? 1 : 0, $post['Description'], $post['Location'], $post['colorvalue'], $post['timezone']);        } else {            $ret = addDetailedCalendar($st, $et, $post['Subject'], $post['IsAllDayEvent'] ? 1 : 0, $post['Description'], $post['Location'], $post['colorvalue'], $post['timezone']);        }        break;}echo json_encode($ret);